name: Configure AWS Credentials
uses: aws-actions/configure-aws-credentials@v1
with:
  aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
  aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
  aws-region: us-east-1

name: Login to Amazon ECR
id: login-ecr
uses: aws-actions/amazon-ecr-login@v1

name: Build and tag Docker image
run: |
  docker build -t 3dvista .
  docker tag 3dvista:latest ${{ steps.login-ecr.outputs.registry }}.dkr.ecr.us-east-1.amazonaws.com/3dvista:latest

name: Push image to ECR
run: |
  docker push ${{ steps.login-ecr.outputs.registry }}.dkr.ecr.us-east-1.amazonaws.com/3dvista:latest
